@model IEnumerable<CarRentalSystem.Models.Car>
@inject IHttpContextAccessor HttpContextAccessor

@{
    ViewData["Title"] = "Browse Cars";
    var userRole = HttpContextAccessor.HttpContext.Session.GetString("Role");
}

<style>
    .btn-gold {
        background: linear-gradient(90deg, #FFD700, #FFC107);
        color: #fff;
        border: none;
        transition: transform 0.2s, box-shadow 0.2s;
    }

        .btn-gold:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(255, 215, 0, 0.4);
        }

    .btn-outline-gold {
        border: 1px solid #FFD700;
        color: #FFD700;
        transition: all 0.2s;
    }

        .btn-outline-gold:hover {
            background: #FFD700;
            color: #fff;
        }

    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        transition: all 0.3s ease-in-out;
    }

    .text-gold {
        background: linear-gradient(90deg, #FFD700, #FFC107);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }
</style>

<div class="container my-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="fw-bold text-gold">Our Fleet</h1>
        @if (userRole == "Admin")
        {
            <a asp-action="Create" class="btn btn-gold shadow-sm">
                <i class="bi bi-plus-circle"></i> Add New Car
            </a>
        }
    </div>

    <div class="row g-4">
        @foreach (var item in Model)
        {
            <div class="col-lg-4 col-md-6">
                <div class="card h-100 shadow-lg border-0 rounded-4 overflow-hidden">
                    <img src="@Url.Content(item.ImageUrl)" class="card-img-top" alt="@item.CarName"
                         style="height: 240px; object-fit: cover;" />
                    <div class="card-body d-flex flex-column">
                        <h5 class="fw-bold">@item.CarName <small class="text-muted">(@item.CarModel)</small></h5>
                        <p class="text-muted small">@item.Description</p>
                        <ul class="list-group list-group-flush small mb-3">
                            <li class="list-group-item">Type: <span class="fw-bold">@item.CarType</span></li>
                            <li class="list-group-item">Seats: @item.SeatingCapacity</li>
                            <li class="list-group-item">Transmission: @item.Transmission</li>
                            <li class="list-group-item">Mileage: @item.Mileage?.ToString("N0") km</li>
                            <li class="list-group-item text-success fw-bold">Rate: $@item.DailyRate.ToString("F2") / day</li>
                        </ul>
                        <div class="mt-auto d-flex justify-content-center gap-2">
                            @if (item.IsAvailable)
                            {
                                <a asp-controller="Bookings" asp-action="Create" asp-route-carId="@item.CarID"
                                   class="btn btn-gold btn-sm shadow">Book Now</a>
                            }
                            else
                            {
                                <button class="btn btn-secondary btn-sm" disabled>Not Available</button>
                            }
                            <a asp-action="Details" asp-route-id="@item.CarID" class="btn btn-outline-gold btn-sm">Details</a>
                        </div>
                    </div>

                    @if (userRole == "Admin")
                    {
                        <div class="card-footer text-center bg-light d-flex justify-content-center gap-2">
                            <a asp-action="Edit" asp-route-id="@item.CarID" class="btn btn-sm btn-outline-warning">Edit</a>
                            <a asp-action="Delete" asp-route-id="@item.CarID" class="btn btn-sm btn-outline-danger">Delete</a>
                        </div>
                    }
                </div>
            </div>
        }
    </div>
</div>
